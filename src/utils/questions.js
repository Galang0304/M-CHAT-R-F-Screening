export const mchatQuestions = [
  {
    id: 1,
    text: "Jika Anda menunjuk sesuatu di seberang ruangan, apakah anak Anda melihat ke arah benda tersebut?",
    kriteria: {
      lulus: [
        "Melihat ke arah benda yang ditunjuk",
        "Menunjuk ke benda tersebut",
        "Melihat dan berkomentar tentang benda",
        "Melihat ketika orang tua menunjuk dan berkata 'lihat'"
      ],
      gagal: [
        "Mengabaikan orang tua",
        "Melihat sekeliling ruangan secara acak",
        "Hanya melihat jari orang tua"
      ]
    }
  },
  {
    id: 2,
    text: "Pernahkah Anda bertanya-tanya apakah anak Anda tuli?",
    kriteria: {
      lulus: [
        "Merespon ketika dipanggil namanya",
        "Merespon terhadap suara-suara",
        "Tidak mengabaikan suara atau orang"
      ],
      gagal: [
        "Sering mengabaikan suara",
        "Sering mengabaikan orang yang berbicara",
        "Tidak merespon ketika dipanggil"
      ]
    }
  },
  {
    id: 3,
    text: "Apakah anak Anda bermain pura-pura?",
    kriteria: {
      lulus: [
        "Berpura-pura minum dari cangkir mainan",
        "Berpura-pura makan dengan sendok mainan",
        "Berpura-pura berbicara di telepon",
        "Berpura-pura memberi makan boneka",
        "Bermain peran dengan mainan (sopir, penumpang, dll)"
      ],
      gagal: [
        "Tidak pernah bermain pura-pura",
        "Hanya menggunakan mainan secara harfiah",
        "Tidak menunjukkan permainan imajinatif"
      ]
    }
  },
  {
    id: 4,
    text: "Apakah anak Anda suka memanjat benda-benda?",
    kriteria: {
      lulus: [
        "Memanjat perabotan",
        "Memanjat peralatan bermain",
        "Memanjat tangga",
        "Menunjukkan ketertarikan untuk mengeksplorasi lingkungan"
      ],
      gagal: [
        "Tidak tertarik memanjat sama sekali",
        "Terlalu takut atau pasif",
        "Hanya diam di satu tempat"
      ]
    }
  },
  {
    id: 5,
    text: "Apakah anak Anda membuat gerakan jari yang tidak biasa di dekat matanya?",
    kriteria: {
      lulus: [
        "Tidak membuat gerakan jari yang aneh",
        "Gerakan jari normal sesuai usia",
        "Tidak ada stimulasi visual berulang"
      ],
      gagal: [
        "Mengibas-ngibaskan jari di dekat mata",
        "Menatap jari yang bergerak",
        "Gerakan jari repetitif dan tidak wajar"
      ]
    }
  },
  {
    id: 6,
    text: "Apakah anak Anda menunjuk dengan satu jari untuk meminta sesuatu atau meminta bantuan?",
    kriteria: {
      lulus: [
        "Menunjuk untuk meminta benda yang diinginkan",
        "Menggunakan jari telunjuk untuk menunjuk",
        "Menunjuk sambil melihat ke orang tua"
      ],
      gagal: [
        "Hanya menggunakan seluruh tangan",
        "Menarik tangan orang tua ke benda",
        "Tidak pernah menunjuk untuk meminta"
      ]
    }
  },
  {
    id: 7,
    text: "Apakah anak Anda menunjuk dengan satu jari untuk menunjukkan ketertarikan pada sesuatu?",
    kriteria: {
      lulus: [
        "Menunjuk objek yang menarik perhatiannya",
        "Menunjuk sambil melihat ke orang tua",
        "Ingin berbagi ketertarikan dengan orang lain"
      ],
      gagal: [
        "Tidak pernah menunjuk untuk berbagi ketertarikan",
        "Tidak menunjukkan keinginan berbagi pengalaman",
        "Hanya menunjuk ketika menginginkan sesuatu"
      ]
    }
  },
  {
    id: 8,
    text: "Apakah anak Anda tertarik pada anak-anak lain?",
    kriteria: {
      lulus: [
        "Menunjukkan ketertarikan pada anak sebaya",
        "Mencoba berinteraksi dengan anak lain",
        "Tersenyum pada anak lain",
        "Merespon ketika didekati anak lain"
      ],
      gagal: [
        "Mengabaikan anak-anak lain",
        "Tidak menunjukkan minat bersosialisasi",
        "Lebih suka bermain sendiri",
        "Tidak merespon pendekatan anak lain"
      ]
    }
  },
  {
    id: 9,
    text: "Apakah anak Anda menunjukkan benda-benda kepada Anda dengan membawanya atau mengangkatnya agar Anda dapat melihatnya?",
    kriteria: {
      lulus: [
        "Menunjukkan mainan atau benda yang menarik",
        "Membawa benda untuk ditunjukkan",
        "Ingin berbagi kesenangan dengan orang tua",
        "Mencari perhatian untuk berbagi"
      ],
      gagal: [
        "Hanya membawa benda untuk mendapat bantuan",
        "Tidak pernah menunjukkan benda pada orang lain",
        "Tidak ada keinginan berbagi pengalaman"
      ]
    }
  },
  {
    id: 10,
    text: "Apakah anak Anda merespons ketika namanya dipanggil?",
    kriteria: {
      lulus: [
        "Menoleh ketika dipanggil namanya",
        "Melihat ke arah orang yang memanggil",
        "Merespon dengan suara atau gerakan",
        "Menghentikan aktivitas untuk merespon"
      ],
      gagal: [
        "Tidak merespon ketika dipanggil",
        "Hanya merespon pada suara keras",
        "Tidak konsisten dalam merespon",
        "Perlu dipanggil berulang kali"
      ]
    }
  },
  {
    id: 11,
    text: "Ketika Anda tersenyum kepada anak Anda, apakah dia tersenyum kembali kepada Anda?",
    kriteria: {
      lulus: [
        "Membalas senyuman secara spontan",
        "Tersenyum saat berinteraksi sosial",
        "Menunjukkan ekspresi wajah yang sesuai"
      ],
      gagal: [
        "Tidak membalas senyuman",
        "Tersenyum tanpa sebab yang jelas",
        "Ekspresi wajah tidak sesuai konteks"
      ]
    }
  },
  {
    id: 12,
    text: "Apakah anak Anda terganggu oleh suara sehari-hari?",
    kriteria: {
      lulus: [
        "Tidak menunjukkan reaksi berlebihan pada suara biasa",
        "Dapat mentoleransi suara lingkungan",
        "Reaksi normal terhadap suara keras"
      ],
      gagal: [
        "Sangat sensitif terhadap suara",
        "Menutup telinga pada suara biasa",
        "Menangis atau marah pada suara tertentu",
        "Reaksi berlebihan pada suara sehari-hari"
      ]
    }
  },
  {
    id: 13,
    text: "Apakah anak Anda berjalan?",
    kriteria: {
      lulus: [
        "Berjalan mandiri tanpa bantuan",
        "Keseimbangan yang baik",
        "Dapat berjalan tanpa berpegangan"
      ],
      gagal: [
        "Belum bisa berjalan mandiri",
        "Selalu perlu berpegangan",
        "Pola berjalan tidak normal"
      ]
    }
  },
  {
    id: 14,
    text: "Apakah anak Anda melihat mata Anda ketika Anda berbicara dengannya, bermain dengannya, atau mengganti pakaiannya?",
    kriteria: {
      lulus: [
        "Membuat kontak mata saat berinteraksi",
        "Mempertahankan kontak mata yang sesuai",
        "Melihat mata saat diajak bicara"
      ],
      gagal: [
        "Menghindari kontak mata",
        "Kontak mata sangat singkat/sekilas",
        "Tidak pernah melihat mata saat berinteraksi"
      ]
    }
  },
  {
    id: 15,
    text: "Apakah anak Anda mencoba meniru gerakan yang Anda lakukan?",
    kriteria: {
      lulus: [
        "Meniru gerakan sederhana",
        "Mencoba meniru tepuk tangan",
        "Meniru lambaian tangan",
        "Meniru ekspresi wajah"
      ],
      gagal: [
        "Tidak tertarik meniru",
        "Tidak memperhatikan gerakan orang lain",
        "Tidak ada usaha untuk meniru"
      ]
    }
  },
  {
    id: 16,
    text: "Jika Anda menoleh untuk melihat sesuatu, apakah anak Anda melihat ke sekeliling untuk melihat apa yang Anda lihat?",
    kriteria: {
      lulus: [
        "Mengikuti arah pandangan orang tua",
        "Mencari apa yang dilihat orang tua",
        "Menunjukkan perhatian bersama"
      ],
      gagal: [
        "Tidak mengikuti arah pandangan",
        "Tetap fokus pada aktivitasnya sendiri",
        "Tidak menunjukkan ketertarikan"
      ]
    }
  },
  {
    id: 17,
    text: "Apakah anak Anda mencoba membuat Anda melihat kepadanya?",
    kriteria: {
      lulus: [
        "Mencari perhatian dengan cara positif",
        "Menunjukkan apa yang dia lakukan",
        "Ingin berbagi kesenangan"
      ],
      gagal: [
        "Tidak mencari perhatian",
        "Hanya mencari perhatian saat butuh bantuan",
        "Tidak ada inisiatif interaksi"
      ]
    }
  },
  {
    id: 18,
    text: "Apakah anak Anda mengerti ketika Anda menyuruhnya melakukan sesuatu?",
    kriteria: {
      lulus: [
        "Memahami instruksi sederhana",
        "Merespon perintah tanpa isyarat",
        "Dapat mengikuti arahan verbal"
      ],
      gagal: [
        "Tidak memahami instruksi sederhana",
        "Hanya merespon dengan isyarat",
        "Tidak konsisten dalam merespon perintah"
      ]
    }
  },
  {
    id: 19,
    text: "Jika terjadi sesuatu yang baru, apakah anak Anda melihat wajah Anda untuk melihat bagaimana perasaan Anda tentang hal tersebut?",
    kriteria: {
      lulus: [
        "Memeriksa reaksi orang tua pada situasi baru",
        "Mencari panduan sosial",
        "Menunjukkan referensi sosial"
      ],
      gagal: [
        "Tidak memeriksa reaksi orang tua",
        "Tidak peduli dengan respons orang lain",
        "Bereaksi tanpa melihat respons orang tua"
      ]
    }
  },
  {
    id: 20,
    text: "Apakah anak Anda menyukai aktivitas bergerak?",
    kriteria: {
      lulus: [
        "Menikmati diayun",
        "Senang digendong",
        "Tertawa saat aktivitas bergerak",
        "Meminta untuk diayun/digendong"
      ],
      gagal: [
        "Tidak suka digerakkan",
        "Menangis saat diayun/digendong",
        "Menolak aktivitas bergerak",
        "Kaku saat digerakkan"
      ]
    }
  }
]

export const followUpQuestions = {
  1: {
    initialQuestion: "Apakah anak melihat ke arah benda yang Anda tunjuk?",
    subQuestions: {
      lulus: [
        "Melihat ke arah benda?",
        "Menunjuk ke benda?",
        "Melihat berkeliling untuk melihat benda?",
        "Menyebut benda?",
        "Melihat ke arah orang tua kemudian ke benda?"
      ],
      gagal: [
        "Mengabaikan orang tua",
        "Melihat sekeliling ruangan secara acak",
        "Melihat jari orang tua"
      ]
    },
    evaluasi: (jawaban) => {
      if (jawaban.lulus.some(j => j === true) && jawaban.gagal.every(j => j === false)) {
        return "LULUS"
      }
      return "GAGAL"
    }
  },
  2: {
    initialQuestion: "Apakah anak Anda merespons suara?",
    subQuestions: {
      pertanyaanTambahan: [
        "Sering mengabaikan suara?",
        "Sering mengabaikan orang?"
      ],
      tesPendengaran: {
        dilakukan: true,
        hasil: [
          "Pendengaran dalam batas normal",
          "Pendengaran di bawah normal",
          "Hasil tidak meyakinkan atau tidak definitif"
        ]
      }
    },
    evaluasi: (jawaban) => {
      if (jawaban.pertanyaanTambahan.every(j => j === false) && jawaban.tesPendengaran.hasil.includes("normal")) {
        return "LULUS"
      }
      return "GAGAL"
    }
  },
  3: {
    initialQuestion: "Apakah anak Anda bermain pura-pura?",
    subQuestions: {
      aktivitas: [
        "Berpura-pura minum dari cangkir mainan?",
        "Berpura-pura makan dari sendok atau garpu mainan?",
        "Berpura-pura berbicara di telepon?",
        "Berpura-pura memberi makan boneka atau binatang mainan dengan makanan sungguhan atau khayalan?",
        "Mendorong mobil-mobilan seperti sedang berada di jalan?",
        "Meletakkan panci mainan di atas kompor?",
        "Meletakkan mainan atau boneka ke dalam mobil-mobilan atau truk seolah-olah sebagai sopir atau penumpang?",
        "Berpura-pura menyapu karpet, mengelap lantai atau memotong rumput?"
      ]
    },
    evaluasi: (jawaban) => {
      if (jawaban.aktivitas.every(j => j === false)) {
        return "LULUS"
      }
      return "GAGAL"
    }
  },
  // ... pertanyaan follow-up lainnya ...
}

export const calculateRisk = (score) => {
  if (score <= 2) return 'low'
  if (score <= 7) return 'medium'
  return 'high'
}

export const getRecommendation = (score, isFollowUp = false) => {
  if (isFollowUp) {
    if (score <= 1) {
      return "Hasil skrining negatif. Tidak perlu tindakan lanjutan saat ini. Lakukan skrining ulang saat kunjungan berikutnya."
    }
    return "Hasil skrining positif. Rujuk anak untuk evaluasi diagnostik dan evaluasi eligibilitas untuk intervensi dini."
  }

  if (score <= 2) {
    return "Risiko rendah. Jika anak di bawah 24 bulan, lakukan skrining ulang setelah ulang tahun kedua. Lanjutkan pemantauan perkembangan rutin."
  }
  if (score <= 7) {
    return "Risiko sedang. Perlu dilakukan Follow-Up (M-CHAT-R/F) untuk mendapatkan informasi tambahan tentang respon yang berisiko. Hasil Follow-Up akan menentukan perlu tidaknya rujukan ke spesialis."
  }
  return "Risiko tinggi. Follow-up tidak diperlukan. Segera rujuk untuk evaluasi diagnostik dan evaluasi eligibilitas untuk intervensi dini."
}

// Fungsi untuk menghitung skor berdasarkan jawaban
export const calculateScore = (answers) => {
  let score = 0
  
  // Untuk pertanyaan 2, 5, dan 12, jawaban "YA" mengindikasikan risiko ASD
  const reverseQuestions = [2, 5, 12]
  
  Object.entries(answers).forEach(([questionId, answer]) => {
    const qId = parseInt(questionId) + 1 // Karena index dimulai dari 0
    if (reverseQuestions.includes(qId)) {
      // Untuk pertanyaan 2, 5, dan 12
      if (answer === true) score++ // Jika jawaban "YA"
    } else {
      // Untuk pertanyaan lainnya
      if (answer === false) score++ // Jika jawaban "TIDAK"
    }
  })
  
  return score
}

export const evaluateFollowUp = (questionId, answers) => {
  const question = followUpQuestions[questionId]
  if (!question) return null

  // Logika evaluasi berdasarkan diagram alur
  switch (questionId) {
    case 1:
      if (answers.lulusOnly) return "LULUS"
      if (answers.gagalOnly) return "GAGAL"
      if (answers.mostFrequent === "LULUS") return "LULUS"
      return "GAGAL"
    case 2:
      if (answers.noResponse) return "LULUS"
      if (answers.someResponse) return "GAGAL"
      return null
    // ... tambahkan logika untuk pertanyaan lainnya
    default:
      return null
  }
} 